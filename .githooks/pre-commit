#!/bin/bash

echo "Running git pre-commit hook..."

# virtual environment to isolate the dependencies
if [ ! -d ".venv" ]; then
    virtualenv --quiet .venv
fi
source .venv/bin/activate

# install development dependencies
pip install --quiet -r requirements-dev.txt

# run formatter and add files to commit
# run linter for information
staged_files=$(git diff --staged --name-only)
for file in $staged_files; do 
    if [[ $file == *.py ]]; then
        black --line-length 160 $file
        pylint --max-line-length 160 $file
        git add --update
    fi
done
